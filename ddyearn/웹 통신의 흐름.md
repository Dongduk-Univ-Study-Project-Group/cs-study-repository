## 웹 통신의 흐름

### 브라우저

1. URL에 적힌 값을 파싱  
2. HTTP Request Message를 만든다.  
3. OS에 전송 요청을 한다.

브라우저는 메시지를 네트워크에 송출하는 기능이 없기 때문에 OS에 의뢰하여 메시지를 전달한다.
이 때, 도메인명이 아니라 ip주소를 사용하므로 DNS Lookup을 수행한다.

### DNS Lookup

크롬의 경우 브라우저 → hosts 파일 → DNS Cache의 순서로 도메인에 매칭되는 ip를 찾는다.  
일반적으로 설명하는 DNS Lookup은 루트 도메인서버에서부터 서브도메인 서버순으로 찾는다.

### 프로토콜 스택, LAN 어댑터

4. 프로토콜 스택(OS에 내장된 네트워크 제어용 소프트웨어)이 브라우저로부터 받은 메시지를 패킷에 저장한다.  
5. 수신처 주소 등의 제어 정보를 덧붙인다.
6. LAN 어댑터에 전송한다.  
7. LAN 어댑터는 다음 Hop의 MAC 주소를 붙인 프레임을 전기신호로 변환시킨다.
8. 신호를 LAN 케이블에 송출한다.  

프로토콜 스택은 통신 중 오류가 발생했을 때, 이 제어 정보를 사용하여 고쳐 보내거나, 각종 상황을 조절하는 등 다양한 역할을 한다.

### 스위칭 허브, 라우터

9. LAN 어댑터가 송신한 프레임은 스위칭 허브 등을 경유하여 인터넷 접속용 라우터에 도착한다.
10. 라우터는 패킷을 ISP(통신사)에게 전달한다.
11. 인터넷으로 이동합니다.  

### 엑세스 회선, ISP

12. 액세스 회선에 의해 통신사용 라우터(POP_Point Of Presence)로 운반된다.
13. 인터넷의 핵심부로 전달된다.
14. 고속 라우터들 사이로 목적지까지 패킷이 흘러들어가게 된다.


### 방화벽

15. 핵심부를 통과한 패킷은 목적지의 LAN에 도착한다.  
16. 방화벽이 패킷을 검사한다.  
17. 캐시 서버로 보내어 웹 서버에 갈 필요가 있는지 검사한다.  

굳이 서버까지 가지 않아도 되는 경우를 골라낸다. 엑세스한 페이지의 데이터가 캐시서버에 있으면 웹 서버에 의뢰하지 않고 바로 그 값을 읽을 수 있다.
페이지의 데이터 중에 다시 이용할 수 있는 것이 있으면 캐시 서버에 저장된다.

### 웹 서버

18. 웹 서버에 도착한 패킷은 프로토콜 스택이 패킷을 추출하여 메시지를 복원하고 웹 서버 애플리케이션에 넘긴다.  
19. 메시지를 받은 웹 서버 애플리케이션은 요청에 대한 응답 데이터를 작성하여 클라이언트로 회송한다.
20. 왔던 방식 그대로 응답 메시지가 클라이언트에게 전송된다.

출처: https://github.com/JaeYeopHan/Interview_Question_for_Beginner/tree/master/Network